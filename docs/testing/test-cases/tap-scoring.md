# Тест-кейсы: Регистрация тапов и подсчет очков

## Регистрация тапов

### TC-TAP-001: Успешная регистрация тапа игроком

- **Связанные User Stories**: US-07
- **Приоритет**: P0
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - В системе есть активный раунд
    - Пользователь не находится в списке игнорируемых

- **Шаги**:
    1. Перейти на страницу активного раунда
    2. Нажать кнопку "Тап"

- **Ожидаемый результат**:
    - Тап успешно зарегистрирован
    - Обновляется счетчик тапов пользователя
    - Обновляется общий счетчик тапов в раунде
    - Отображается анимация успешного тапа

- **Среда тестирования**: Все поддерживаемые браузеры, мобильные устройства
- **Автоматизация**: Да, E2E и Integration тесты

### TC-TAP-002: Попытка регистрации тапа вне активного раунда

- **Связанные User Stories**: US-07
- **Приоритет**: P0
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - В системе нет активного раунда

- **Шаги**:
    1. Перейти на главную страницу
    2. Попытаться нажать кнопку "Тап" (если она доступна)
    3. Альтернативно: отправить API-запрос на регистрацию тапа напрямую

- **Ожидаемый результат**:
    - Тап не регистрируется
    - Отображается сообщение: "Невозможно зарегистрировать тап вне активного раунда"
    - API возвращает ошибку с соответствующим сообщением

- **Среда тестирования**: Все поддерживаемые браузеры, API-тестирование
- **Автоматизация**: Да, E2E, Integration и API тесты

### TC-TAP-003: Множественные тапы от одного пользователя

- **Связанные User Stories**: US-07
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - В системе есть активный раунд
    - Пользователь не находится в списке игнорируемых

- **Шаги**:
    1. Перейти на страницу активного раунда
    2. Нажать кнопку "Тап" 10 раз подряд с интервалом 1 секунда

- **Ожидаемый результат**:
    - Все тапы успешно зарегистрированы
    - Счетчик тапов пользователя увеличивается на 10
    - Каждый тап правильно записывается в базу данных с временной меткой
    - Система корректно обрабатывает быстрые последовательные тапы

- **Среда тестирования**: Все поддерживаемые браузеры, мобильные устройства
- **Автоматизация**: Да, Integration и Performance тесты

### TC-TAP-004: Попытка регистрации тапа игнорируемым пользователем

- **Связанные User Stories**: US-07, US-10
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - Пользователь находится в списке игнорируемых
    - В системе есть активный раунд

- **Шаги**:
    1. Перейти на страницу активного раунда
    2. Нажать кнопку "Тап"

- **Ожидаемый результат**:
    - Тап регистрируется в системе
    - Очки за тап не начисляются
    - Пользователь видит уведомление о том, что находится в списке игнорируемых
    - Тап отображается в общей статистике с пометкой "Игнорируемый"

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Integration и E2E тесты

## Подсчет очков

### TC-TAP-005: Корректное начисление очков за тап

- **Связанные User Stories**: US-09
- **Приоритет**: P0
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - В системе есть активный раунд
    - Пользователь не находится в списке игнорируемых
    - Базовое количество очков за тап: 10

- **Шаги**:
    1. Перейти на страницу активного раунда
    2. Нажать кнопку "Тап"
    3. Проверить обновление счета пользователя

- **Ожидаемый результат**:
    - За тап начислено 10 очков
    - Счетчик очков пользователя увеличился на 10
    - В таблице лидеров отображается обновленный счет пользователя

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Unit и Integration тесты

### TC-TAP-006: Применение множителя очков

- **Связанные User Stories**: US-09
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - В системе есть активный раунд с настроенным множителем x2
    - Пользователь не находится в списке игнорируемых
    - Базовое количество очков за тап: 10

- **Шаги**:
    1. Перейти на страницу активного раунда
    2. Нажать кнопку "Тап"
    3. Проверить обновление счета пользователя

- **Ожидаемый результат**:
    - За тап начислено 20 очков (10 × 2)
    - Счетчик очков пользователя увеличился на 20
    - В таблице лидеров отображается обновленный счет пользователя
    - В истории тапов указано применение множителя

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Unit и Integration тесты

### TC-TAP-007: Бонусные очки за комбо тапов

- **Связанные User Stories**: US-09
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - В системе есть активный раунд с настроенными бонусами за комбо
    - Пользователь не находится в списке игнорируемых
    - Настройки комбо: 5 тапов подряд в течение 10 секунд = бонус 50 очков

- **Шаги**:
    1. Перейти на страницу активного раунда
    2. Нажать кнопку "Тап" 5 раз с интервалом 1-2 секунды
    3. Проверить обновление счета пользователя

- **Ожидаемый результат**:
    - За каждый тап начислено стандартное количество очков
    - После 5-го тапа начислен бонус 50 очков
    - Счетчик очков пользователя увеличился на сумму стандартных очков + бонус
    - Отображается анимация или уведомление о получении бонуса за комбо

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Integration тесты

### TC-TAP-008: Обновление таблицы лидеров в реальном времени

- **Связанные User Stories**: US-09, US-11
- **Приоритет**: P1
- **Предусловия**:
    - Открыты две вкладки браузера:
        - Вкладка 1: пользователь Player1 авторизован и находится на странице активного раунда
        - Вкладка 2: пользователь Player2 авторизован и находится на странице активного раунда
    - Оба пользователя не находятся в списке игнорируемых

- **Шаги**:
    1. Во вкладке 1 (Player1) нажать кнопку "Тап" 3 раза
    2. Проверить таблицу лидеров во вкладке 2 (Player2)
    3. Во вкладке 2 (Player2) нажать кнопку "Тап" 5 раз
    4. Проверить таблицу лидеров во вкладке 1 (Player1)

- **Ожидаемый результат**:
    - Таблица лидеров обновляется в реальном времени на обеих вкладках
    - После шага 2 во вкладке 2 видно, что Player1 совершил 3 тапа
    - После шага 4 во вкладке 1 видно, что Player2 совершил 5 тапов и обогнал Player1
    - Порядок игроков в таблице соответствует их текущему счету

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест с несколькими браузерными сессиями

### TC-TAP-009: Окончательный подсчет очков после завершения раунда

- **Связанные User Stories**: US-05, US-09
- **Приоритет**: P0
- **Предусловия**:
    - В системе есть активный раунд с несколькими участниками
    - Раунд близок к завершению (осталось менее 30 секунд)

- **Шаги**:
    1. Дождаться автоматического завершения раунда или завершить раунд вручную
    2. Проверить итоговую таблицу результатов

- **Ожидаемый результат**:
    - После завершения раунда производится окончательный подсчет очков
    - Все тапы, зарегистрированные до момента завершения, учитываются
    - Итоговая таблица результатов отображает правильные суммы очков для всех участников
    - Участники отсортированы по количеству очков (от большего к меньшему)
    - Отображаются награды за 1-е, 2-е и 3-е места

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Integration и E2E тесты

### TC-TAP-010: Корректное отображение личной статистики тапов

- **Связанные User Stories**: US-11
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с ролью игрока
    - Пользователь участвовал в нескольких раундах
    - Пользователь имеет историю тапов

- **Шаги**:
    1. Перейти в раздел "Личная статистика"
    2. Просмотреть общую информацию
    3. Просмотреть историю раундов
    4. Просмотреть графики активности

- **Ожидаемый результат**:
    - Отображается корректная общая статистика: всего тапов, всего очков, участие в раундах
    - История раундов показывает все раунды, в которых участвовал пользователь
    - Для каждого раунда отображается: название, дата, количество тапов, заработанные очки, место
    - Графики активности показывают динамику тапов по времени

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест