# Тест-кейсы: Статистика и отчеты

## Просмотр общей статистики

### TC-STATS-001: Просмотр общей статистики системы администратором

- **Связанные User Stories**: US-11, US-12
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с ролью администратора
    - В системе проведено несколько раундов
    - Имеются данные о тапах и очках

- **Шаги**:
    1. Перейти в раздел "Статистика и аналитика"
    2. Выбрать вкладку "Общая статистика"

- **Ожидаемый результат**:
    - Отображается общая статистика системы:
        - Общее количество проведенных раундов
        - Общее количество тапов
        - Общее количество активных пользователей
        - Среднее количество тапов на раунд
        - График активности по дням/неделям
        - Топ-10 игроков по количеству очков
    - Все данные соответствуют реальной истории использования системы

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-002: Фильтрация общей статистики по периоду

- **Связанные User Stories**: US-11, US-12
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с ролью администратора или модератора
    - В системе проведено несколько раундов в разные периоды времени

- **Шаги**:
    1. Перейти в раздел "Статистика и аналитика"
    2. Выбрать вкладку "Общая статистика"
    3. В фильтре периода выбрать "Последний месяц"
    4. Изучить отображаемые данные
    5. Изменить фильтр на "Последняя неделя"
    6. Изучить обновленные данные

- **Ожидаемый результат**:
    - При выборе "Последний месяц" отображается статистика только за последние 30 дней
    - При выборе "Последняя неделя" отображается статистика только за последние 7 дней
    - Данные автоматически обновляются при изменении фильтра
    - Все графики и числовые показатели корректно отражают выбранный период

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-003: Экспорт общей статистики

- **Связанные User Stories**: US-12
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с ролью администратора
    - Открыта страница общей статистики

- **Шаги**:
    1. Настроить необходимые фильтры (если требуется)
    2. Нажать кнопку "Экспорт статистики"
    3. В диалоговом окне выбрать формат: PDF
    4. Нажать "Скачать"

- **Ожидаемый результат**:
    - Начинается скачивание файла в выбранном формате
    - Файл содержит все данные, отображаемые на странице
    - Графики и таблицы корректно отформатированы для выбранного формата
    - В документе присутствует информация о периоде и примененных фильтрах

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Integration тест

## Статистика по пользователям

### TC-STATS-004: Просмотр рейтинга пользователей

- **Связанные User Stories**: US-11
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с любой ролью
    - В системе есть несколько пользователей с историей тапов и очков

- **Шаги**:
    1. Перейти в раздел "Рейтинг игроков"
    2. Просмотреть таблицу рейтинга

- **Ожидаемый результат**:
    - Отображается таблица рейтинга всех игроков
    - Игроки отсортированы по количеству очков (от большего к меньшему)
    - Для каждого игрока показана информация: место, имя, общее количество очков, количество тапов, среднее число очков за тап
    - Текущий пользователь выделен в таблице
    - Таблицу можно сортировать по разным параметрам

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-005: Просмотр детальной статистики пользователя

- **Связанные User Stories**: US-11
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с любой ролью
    - Пользователь имеет историю участия в раундах

- **Шаги**:
    1. Перейти в раздел "Личная статистика" или "Профиль"
    2. Просмотреть детальную статистику

- **Ожидаемый результат**:
    - Отображается детальная статистика пользователя:
        - Общее количество тапов
        - Общее количество очков
        - Количество участий в раундах
        - Лучший результат (наибольшее количество очков в одном раунде)
        - График активности по дням
        - История раундов с указанием места, очков и даты
    - Все данные соответствуют реальной истории пользователя

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-006: Сравнение статистики пользователей

- **Связанные User Stories**: US-11
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с любой ролью
    - В системе есть несколько пользователей с историей тапов и очков

- **Шаги**:
    1. Перейти в раздел "Рейтинг игроков"
    2. Выбрать двух или более пользователей, установив чекбоксы
    3. Нажать кнопку "Сравнить"

- **Ожидаемый результат**:
    - Открывается страница сравнения выбранных пользователей
    - Отображаются сравнительные графики и таблицы:
        - Сравнение общего количества очков
        - Сравнение количества тапов
        - Сравнение среднего числа очков за тап
        - Сравнение активности по времени
    - Данные корректно отражают статистику каждого пользователя
    - Графики имеют разные цвета для разных пользователей и легенду

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

## Статистика раундов

### TC-STATS-007: Просмотр истории раундов

- **Связанные User Stories**: US-11, US-12
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с ролью администратора или модератора
    - В системе проведено несколько раундов

- **Шаги**:
    1. Перейти в раздел "История раундов"
    2. Просмотреть список раундов

- **Ожидаемый результат**:
    - Отображается список всех проведенных раундов
    - Для каждого раунда показана информация: название, дата начала, длительность, количество участников, общее количество тапов
    - Список можно сортировать по различным параметрам
    - Список можно фильтровать по дате, названию и другим параметрам
    - При клике на раунд открывается его детальная статистика

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-008: Просмотр детальной статистики раунда

- **Связанные User Stories**: US-11, US-12
- **Приоритет**: P1
- **Предусловия**:
    - Пользователь авторизован с любой ролью
    - В системе есть завершенный раунд с ID "round-123"

- **Шаги**:
    1. Перейти в раздел "История раундов"
    2. Найти раунд с ID "round-123"
    3. Нажать на название раунда или кнопку "Подробнее"

- **Ожидаемый результат**:
    - Открывается страница с детальной статистикой раунда
    - Отображается общая информация: название, даты начала и окончания, длительность, общее количество тапов
    - Отображается таблица участников с их результатами
    - Отображается график активности тапов во времени
    - Отображается распределение тапов по пользователям (круговая диаграмма)
    - Все данные соответствуют реальной истории раунда

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-009: Экспорт детальной статистики раунда

- **Связанные User Stories**: US-12
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с ролью администратора или модератора
    - Открыта страница детальной статистики раунда

- **Шаги**:
    1. Нажать кнопку "Экспорт статистики"
    2. В диалоговом окне выбрать формат: Excel
    3. Нажать "Скачать"

- **Ожидаемый результат**:
    - Начинается скачивание файла в формате Excel
    - Файл содержит несколько листов с разными аспектами статистики:
        - Общая информация о раунде
        - Список участников и их результаты
        - Данные о тапах с временными метками
    - Данные корректно отформатированы и соответствуют отображаемым на странице

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, Integration тест

## Аналитические отчеты

### TC-STATS-010: Генерация аналитического отчета за период

- **Связанные User Stories**: US-12
- **Приоритет**: P2
- **Предусловия**:
    - Пользователь авторизован с ролью администратора
    - В системе есть данные за выбранный период

- **Шаги**:
    1. Перейти в раздел "Аналитические отчеты"
    2. Выбрать тип отчета: "Активность системы"
    3. Указать период: последний месяц
    4. Нажать кнопку "Сгенерировать отчет"

- **Ожидаемый результат**:
    - Генерируется отчет за выбранный период
    - Отчет содержит разделы:
        - Сводка (ключевые показатели)
        - Активность пользователей
        - Статистика раундов
        - Тренды и аномалии
    - Отчет включает графики и таблицы с релевантными данными
    - Все расчеты и агрегации выполнены корректно

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-011: Настройка и сохранение шаблона отчета

- **Связанные User Stories**: US-12
- **Приоритет**: P3
- **Предусловия**:
    - Пользователь авторизован с ролью администратора
    - Пользователь находится в разделе "Аналитические отчеты"

- **Шаги**:
    1. Нажать кнопку "Создать шаблон отчета"
    2. Указать название шаблона: "Ежемесячный отчет"
    3. Выбрать включаемые разделы:
        - Общая статистика
        - Активность пользователей
        - Топ-10 игроков
    4. Настроить период: "Последний месяц" (относительный)
    5. Выбрать формат: PDF
    6. Нажать кнопку "Сохранить шаблон"

- **Ожидаемый результат**:
    - Шаблон успешно сохранен
    - Отображается уведомление об успешном сохранении
    - Шаблон появляется в списке доступных шаблонов
    - При выборе шаблона из списка автоматически применяются все сохраненные настройки

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E тест

### TC-STATS-012: Настройка автоматической отправки отчетов

- **Связанные User Stories**: US-12
- **Приоритет**: P3
- **Предусловия**:
    - Пользователь авторизован с ролью администратора
    - У пользователя есть сохраненный шаблон отчета "Ежемесячный отчет"

- **Шаги**:
    1. Перейти в раздел "Аналитические отчеты"
    2. Выбрать вкладку "Расписание отчетов"
    3. Нажать кнопку "Добавить расписание"
    4. Выбрать шаблон: "Ежемесячный отчет"
    5. Настроить периодичность: "Ежемесячно, 1-е число"
    6. Указать получателей: "admin@example.com, manager@example.com"
    7. Указать тему письма: "Ежемесячный отчет активности системы"
    8. Нажать кнопку "Сохранить расписание"

- **Ожидаемый результат**:
    - Расписание успешно сохранено
    - Отображается уведомление об успешном сохранении
    - Расписание появляется в списке активных расписаний
    - В указанное время отчет будет автоматически сгенерирован и отправлен получателям

- **Среда тестирования**: Все поддерживаемые браузеры
- **Автоматизация**: Да, E2E и Integration тесты